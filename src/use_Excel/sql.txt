SELECT 
DATE_FORMAT(ADDDATE(19900101,req.`log_date`),'%Y-%m-%d') AS log_date
,COUNT(1) AS cnt
,CAST(SUM(CASE WHEN req.`return_no` = 1 THEN 1 ELSE 0 END) AS SIGNED) AS login_succeed_cnt
,CAST(SUM(CASE WHEN req.`return_no` = 1 THEN 0 ELSE 1 END) AS SIGNED) AS login_failed_cnt
,CAST(SUM(CASE WHEN req.`return_no` = -5 THEN 1 ELSE 0 END) AS SIGNED) AS login_5_cnt
FROM t_tc50_login_req_201711 AS req
GROUP BY req.`log_date`
ORDER BY req.`log_date`;

